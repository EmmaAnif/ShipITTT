<!DOCTYPE html>
<html>
<head>
    <title>Cart - Baru</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <h1>Baru</h1>
    <nav>
        <a href="index.html">Home</a>
        <a href="shipments.html">Add Shipment</a>
    </nav>
</header>

<div class="container">
    <h2>Your Shipments</h2>
    <div id="cartList"></div>
    <h3 id="totalCost"></h3>
    <button onclick="confirmOrder()">Make Payment</button>
</div>

<script>
let cart = JSON.parse(localStorage.getItem("cart") || "[]");
const costPerKg = 5; // dummy rate per kg

function displayCart() {
    const list = document.getElementById("cartList");
    list.innerHTML = "";
    let totalWeight = 0;

    if (cart.length === 0) {
        list.innerHTML = "<p>No shipments in cart.</p>";
        document.getElementById("totalCost").textContent = "";
        return;
    }

    cart.forEach((item, idx) => {
        totalWeight += item.weight;
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
            <p><b>Supplier Phone:</b> ${item.supplierPhone}</p>
            <p><b>Instagram:</b> ${item.supplierInstagram}</p>
            <p><b>Weight:</b> ${item.weight} kg</p>
            <button style="background-color:#333;color:#00ff00;" onclick="deleteItem(${idx})">Delete</button>
        `;
        list.appendChild(div);
    });

    const estimatedCost = totalWeight * costPerKg;
    document.getElementById("totalCost").textContent =
        `Estimated Shipping Cost: $${estimatedCost.toFixed(2)}`;
}

function deleteItem(index) {
    if (confirm("Remove this shipment from the cart?")) {
        cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        displayCart();
        updateCartCounter();
    }
}

function confirmOrder() {
    if (cart.length === 0) {
        alert("Your cart is empty.");
        return;
    }
    // After "payment", empty cart
    localStorage.removeItem("cart");
    window.location.href = "confirmation.html";
}

// Update cart counter in header
function updateCartCounter() {
    const counter = document.querySelector(".cart-counter");
    counter.textContent = cart.length;
}

displayCart();
updateCartCounter();
</script>
</body>
</html>
